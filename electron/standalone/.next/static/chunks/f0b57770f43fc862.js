(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,31555,e=>{"use strict";var t=e.i(18050),s=e.i(71645),a=e.i(95187),r=(0,a.createServerReference)("40802d964a6a127943dbd1d5f636967825caeed92d",a.callServer,void 0,a.findSourceMapURL,"createMemo"),n=e.i(19455),i=e.i(82735),l=e.i(75254);let o=(0,l.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);var d=e.i(37727),c=e.i(94008);let m=(0,l.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var h=e.i(68692);function u({categoryId:e,onCreated:a}){let[l,u]=(0,s.useState)(""),[x,f]=(0,s.useState)(""),[p,g]=(0,s.useState)([]),[j,v]=(0,s.useState)(!1),w=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=[];return p.forEach(t=>{t.type.startsWith("image/")&&e.push(URL.createObjectURL(t))}),()=>{e.forEach(e=>URL.revokeObjectURL(e))}},[p]);let y=async t=>{if(t?.preventDefault(),!l.trim()&&0===p.length&&!x.trim()||j)return;v(!0);let s=new FormData;s.append("content",l),x.trim()&&s.append("title",x.trim()),s.append("categoryId",e),p.forEach(e=>s.append("files",e));try{await r(s),u(""),f(""),g([]),a?.()}catch(e){console.error(e)}finally{v(!1)}};return(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[p.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2 px-2 pb-2",children:p.map((e,s)=>(0,t.jsxs)("div",{className:"flex items-center gap-2 bg-muted rounded-md px-2 py-1.5 text-xs text-muted-foreground border relative group",children:[e.type.startsWith("image/")?(0,t.jsx)("img",{src:URL.createObjectURL(e),alt:e.name,className:"h-8 w-8 object-cover rounded shadow-sm"}):e.type.startsWith("video/")?(0,t.jsxs)("div",{className:"h-8 w-8 bg-black/10 flex items-center justify-center rounded shadow-sm text-foreground",children:[(0,t.jsx)(m,{className:"h-4 w-4 hidden"})," ",(0,t.jsx)(o,{className:"h-4 w-4 hidden"}),(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-film",children:[(0,t.jsx)("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}),(0,t.jsx)("path",{d:"M7 3v18"}),(0,t.jsx)("path",{d:"M3 7.5h4"}),(0,t.jsx)("path",{d:"M3 12h18"}),(0,t.jsx)("path",{d:"M3 16.5h4"}),(0,t.jsx)("path",{d:"M17 3v18"}),(0,t.jsx)("path",{d:"M17 7.5h4"}),(0,t.jsx)("path",{d:"M17 16.5h4"})]})]}):e.type.startsWith("audio/")?(0,t.jsx)("div",{className:"h-8 w-8 bg-primary/10 flex items-center justify-center rounded shadow-sm text-primary",children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-music",children:[(0,t.jsx)("path",{d:"M9 18V5l12-2v13"}),(0,t.jsx)("circle",{cx:"6",cy:"18",r:"3"}),(0,t.jsx)("circle",{cx:"18",cy:"16",r:"3"})]})}):(0,t.jsx)(c.File,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"max-w-[150px] truncate",children:e.name}),(0,t.jsx)("button",{type:"button",onClick:()=>{g(p.filter((e,t)=>t!==s))},className:"ml-1 hover:text-foreground text-muted-foreground/50 transition-colors",children:(0,t.jsx)(d.X,{className:"h-3 w-3"})})]},s))}),(0,t.jsx)("div",{className:"relative flex flex-col gap-0 bg-muted/30 rounded-xl border focus-within:ring-1 focus-within:ring-ring transition-all overflow-hidden mt-0",children:(0,t.jsxs)("form",{onSubmit:y,children:[(0,t.jsx)("input",{type:"text",value:x,onChange:e=>f(e.target.value),placeholder:"Title (Optional)",className:"px-4 pt-3 pb-1 bg-transparent border-0 focus:ring-0 text-sm font-bold text-foreground placeholder:text-muted-foreground/50 w-full focus:outline-none",disabled:j}),(0,t.jsxs)("div",{className:"flex items-end gap-2 p-2 pt-0",children:[(0,t.jsx)("input",{type:"file",multiple:!0,className:"hidden",ref:w,onChange:e=>{e.target.files&&e.target.files.length>0&&g(t=>[...t,...Array.from(e.target.files)])},onClick:e=>{e.target.value=""}}),(0,t.jsxs)(n.Button,{type:"button",size:"icon",variant:"ghost",disabled:j,className:"rounded-full h-9 w-9 text-muted-foreground hover:text-foreground shrink-0 mb-0.5",onClick:()=>w.current?.click(),children:[(0,t.jsx)(i.Paperclip,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"sr-only",children:"Attach file"})]}),(0,t.jsx)(h.MarkdownInput,{value:l,onChange:e=>u(e),onPaste:e=>{if(e.clipboardData.files.length>0){let t=Array.from(e.clipboardData.files).filter(e=>e.type.startsWith("image/"));t.length>0&&(e.preventDefault(),g(e=>[...e,...t]))}},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||e.nativeEvent.isComposing||(e.preventDefault(),y())},placeholder:x?"Message...":"Message (hold Shift + Enter for new line)",className:"w-full"}),(0,t.jsxs)(n.Button,{type:"submit",size:"icon",disabled:j||!l.trim()&&0===p.length,className:"rounded-full h-9 w-9 shrink-0 mb-0.5",variant:l.trim()||p.length>0?"default":"secondary",children:[(0,t.jsx)(o,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:"sr-only",children:"Send"})]})]})]})})]})}var x=e.i(59684);let f=(0,l.default)("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),p=(0,l.default)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);var g=e.i(75157),j=e.i(26999),v=e.i(95926);function w({...e}){return(0,t.jsx)(j.Root,{"data-slot":"sheet",...e})}function y({...e}){return(0,t.jsx)(j.Trigger,{"data-slot":"sheet-trigger",...e})}function b({...e}){return(0,t.jsx)(j.Portal,{"data-slot":"sheet-portal",...e})}function N({className:e,...s}){return(0,t.jsx)(j.Overlay,{"data-slot":"sheet-overlay",className:(0,g.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...s})}function k({className:e,children:s,side:a="right",...r}){return(0,t.jsxs)(b,{children:[(0,t.jsx)(N,{}),(0,t.jsxs)(j.Content,{"data-slot":"sheet-content",className:(0,g.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===a&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===a&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===a&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===a&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",e),...r,children:[s,(0,t.jsxs)(j.Close,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,t.jsx)(v.XIcon,{className:"size-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function C({className:e,...s}){return(0,t.jsx)("div",{"data-slot":"sheet-header",className:(0,g.cn)("flex flex-col gap-1.5 p-4",e),...s})}function M({className:e,...s}){return(0,t.jsx)(j.Title,{"data-slot":"sheet-title",className:(0,g.cn)("text-foreground font-semibold",e),...s})}var S=e.i(40433);let L=(0,l.default)("arrow-down-to-line",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);var R=e.i(18789),z=e.i(22016),E=e.i(92471),T=e.i(66955),A=e.i(65620);function B(e){let t=e.match(/(https?:\/\/[^\s]+)/g);return t?Array.from(new Set(t.map(e=>e.replace(/[.,;!?)]+$/,"")))):[]}function I({memos:e}){let[a,r]=(0,s.useState)(!1),i=e.filter(e=>e.isPinned);return(0,t.jsxs)(w,{open:a,onOpenChange:r,children:[(0,t.jsx)(y,{asChild:!0,children:(0,t.jsx)(n.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",children:(0,t.jsx)(S.Pin,{className:"h-4 w-4"})})}),(0,t.jsxs)(k,{className:"overflow-y-auto w-[400px] sm:w-[540px]",children:[(0,t.jsx)(C,{children:(0,t.jsx)(M,{children:"Pinned Messages"})}),(0,t.jsx)("div",{className:"mt-4 flex flex-col gap-4 px-[5px]",children:0===i.length?(0,t.jsx)("div",{className:"text-center text-muted-foreground text-sm italic py-10",children:"No pinned messages in this channel."}):i.map(e=>(0,t.jsxs)("div",{className:"border rounded-lg overflow-hidden flex flex-col",children:[(0,t.jsxs)(z.default,{href:`?memoId=${e.id}`,className:"block p-3 hover:bg-muted/50 transition-colors text-sm flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,t.jsx)("span",{className:"font-bold text-xs truncate max-w-[200px]",children:e.title||"No Title"}),(0,t.jsx)("span",{className:"text-[10px] text-muted-foreground",children:new Date(e.createdAt).toLocaleDateString()})]}),(0,t.jsx)("div",{className:"text-muted-foreground [&>p]:mb-1 mb-2",children:(0,t.jsx)(R.default,{components:{a:({node:e,...a})=>{let r=s.default.Children.toArray(a.children);return 1===r.length&&r[0]===a.href?null:(0,t.jsx)("span",{className:"text-primary underline",...a})}},children:e.content})}),e.attachments.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-1 mb-2",children:e.attachments.map(e=>(0,t.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,t.jsx)(E.FilePreview,{attachment:e})},e.id))}),B(e.content).length>0&&(0,t.jsx)("div",{className:"mt-2 space-y-2",children:B(e.content).map(e=>{let s,a=(s=e.match(/^https?:\/\/(?:www\.)?(?:twitter|x)\.com\/\w+\/status\/(\d+)/))?s[1]:null;return a?(0,t.jsx)(A.TweetPreview,{id:a},e):(0,t.jsx)("div",{onClick:e=>e.stopPropagation(),children:(0,t.jsx)(T.LinkPreview,{url:e})},e)})})]}),(0,t.jsx)("div",{className:"p-2 border-t bg-muted/20 flex justify-end",children:(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",className:"gap-2 h-7 text-xs",onClick:()=>{var t;return t=e.id,void(r(!1),setTimeout(()=>{let e=document.getElementById(`memo-${t}`);e&&(e.scrollIntoView({behavior:"smooth",block:"center"}),e.classList.add("ring-2","ring-primary","ring-offset-2"),setTimeout(()=>{e.classList.remove("ring-2","ring-primary","ring-offset-2")},2e3))},100))},children:[(0,t.jsx)(L,{className:"h-3.5 w-3.5"}),"Jump to Memo"]})})]},e.id))})]})]})}var P=e.i(75019),W=(0,a.createServerReference)("607c4c64c68b111fc49d37ac5d1c8fe27557b1b294",a.callServer,void 0,a.findSourceMapURL,"saveWorkspaceSetting"),U=(0,a.createServerReference)("4009b196b472a3672337864e4213ada69b5c6cf7ee",a.callServer,void 0,a.findSourceMapURL,"searchMemos"),D=e.i(18566),O=e.i(93479),$=e.i(55436);let V=(0,l.default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var F=e.i(27025);let K=(0,l.default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var q=e.i(7240);function H({category:e,initialMemos:a,initialViewMode:r="list",readOnly:i=!1}){let l=(0,D.useRouter)(),[o,d]=(0,s.useState)(r),[c,m]=(0,s.useState)(new Set),h=(0,s.useRef)(null);(0,s.useRef)(!0);let[j,v]=(0,s.useState)(""),[w,y]=(0,s.useState)("current"),[b,N]=(0,s.useState)([]),[k,C]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=setTimeout(async()=>{if(!j.trim())return void N([]);if("current"===w){let e=j.toLowerCase();N(a.filter(t=>!e||t.content.toLowerCase().includes(e)||t.title&&t.title.toLowerCase().includes(e)||t.tags.some(t=>t.name.toLowerCase().includes(e))||t.embeds&&t.embeds.some(t=>t.title&&t.title.toLowerCase().includes(e)||t.description&&t.description.toLowerCase().includes(e)||t.siteName&&t.siteName.toLowerCase().includes(e))))}else{C(!0);try{let e=await U(j);N(e)}catch(e){console.error("Search failed",e)}finally{C(!1)}}},300);return()=>clearTimeout(e)},[j,w,a]),(0,s.useEffect)(()=>{if(window.location.hash){let e=window.location.hash.substring(1);if(e.startsWith("memo-")){let t=document.getElementById(e);t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),t.classList.add("bg-primary/20","rounded-lg","transition-colors","duration-1000"),setTimeout(()=>{t.classList.remove("bg-primary/20")},2e3))}}},[a,l]);let M=!!j.trim(),S=M?b:a,L=async e=>{d(e),await W("viewMode",e)},[R,z]=(0,s.useState)(1);(0,s.useEffect)(()=>{let e=()=>{window.innerWidth>=1280?z(3):window.innerWidth>=768?z(2):z(1)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let E=s.default.useMemo(()=>{if("list"===o)return[S];let e=Array.from({length:R},()=>[]),t=Array(R).fill(0);return S.forEach(s=>{let a,r,n=0,i=t[0];for(let e=1;e<R;e++)t[e]<i&&(i=t[e],n=e);e[n].push(s),t[n]+=(a=100+20*Math.ceil((s.content?.length||0)/50),s.attachments?.length&&(a+=200*s.attachments.length),(r=s.content?.match(/(https?:\/\/[^\s]+)/g))&&(a+=300*r.length),a)}),e},[S,R,o]);return(0,t.jsxs)("div",{className:"flex flex-col h-full bg-background/50 backdrop-blur-sm",children:[(0,t.jsxs)(q.DraggableHeader,{className:"h-14 border-b flex items-center justify-between px-4 shrink-0 shadow-sm bg-background/80 backdrop-blur z-10 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 font-bold text-lg shrink-0",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-2xl",children:"#"}),e.name]}),(0,t.jsxs)("div",{className:"flex-1 max-w-md relative flex items-center gap-2 no-drag",style:{WebkitAppRegion:"no-drag"},children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)($.Search,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(O.Input,{placeholder:i?"Search all memos...":"Search memos...",className:"pl-9 h-9 bg-background/50",value:j,onChange:e=>v(e.target.value)})]}),j&&!i&&(0,t.jsxs)("div",{className:"flex items-center border rounded-md overflow-hidden shrink-0",children:[(0,t.jsxs)("button",{onClick:()=>y("current"),className:(0,g.cn)("px-2 py-1.5 text-xs font-medium transition-colors flex items-center gap-1","current"===w?"bg-primary text-primary-foreground":"hover:bg-muted"),title:"Current Channel",children:[(0,t.jsx)(F.Folder,{className:"h-3 w-3"}),"Current"]}),(0,t.jsx)("div",{className:"w-[1px] bg-border h-full"}),(0,t.jsxs)("button",{onClick:()=>y("all"),className:(0,g.cn)("px-2 py-1.5 text-xs font-medium transition-colors flex items-center gap-1","all"===w?"bg-primary text-primary-foreground":"hover:bg-muted"),title:"All Channels",children:[(0,t.jsx)(V,{className:"h-3 w-3"}),"All"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 shrink-0 no-drag",style:{WebkitAppRegion:"no-drag"},children:[(0,t.jsx)(I,{memos:a}),(0,t.jsxs)("div",{className:"bg-muted/50 p-1 rounded-md flex space-x-1",children:[(0,t.jsx)(n.Button,{variant:"list"===o?"secondary":"ghost",size:"icon",className:"h-7 w-7",onClick:()=>L("list"),children:(0,t.jsx)(p,{className:"h-4 w-4"})}),(0,t.jsx)(n.Button,{variant:"grid"===o?"secondary":"ghost",size:"icon",className:"h-7 w-7",onClick:()=>L("grid"),children:(0,t.jsx)(f,{className:"h-4 w-4"})})]})]})]}),(0,t.jsx)(x.ScrollArea,{className:"flex-1 min-h-0",children:(0,t.jsxs)("div",{className:"p-4 pb-4",children:[!M&&0===a.length&&(0,t.jsxs)("div",{className:"text-center text-muted-foreground py-20",children:[(0,t.jsx)("div",{className:"text-lg font-medium mb-2",children:"No memos yet"}),(0,t.jsx)("div",{className:"text-sm",children:i?"Your timeline is empty.":`Be the first to create a memo in #${e.name}!`})]}),M&&0===b.length&&!k&&(0,t.jsxs)("div",{className:"text-center text-muted-foreground py-20",children:[(0,t.jsx)("div",{className:"text-lg font-medium mb-2",children:"No results found"}),(0,t.jsx)("div",{className:"text-sm",children:"Try a different query"})]}),(0,t.jsx)("div",{className:(0,g.cn)("flex gap-4","list"===o?"flex-col":"flex-row items-start"),children:E.map((s,a)=>(0,t.jsx)("div",{className:"flex-1 flex flex-col gap-4 min-w-0",children:s.map(s=>(0,t.jsxs)("div",{id:`memo-${s.id}`,className:"relative group/memo-wrapper",children:[(i||M&&"all"===w&&s.categoryId!==e.id)&&(0,t.jsxs)("div",{className:"mb-1 flex items-center justify-between px-1",children:[(0,t.jsxs)("span",{className:"text-xs text-muted-foreground flex items-center gap-1 bg-muted/50 px-1.5 py-0.5 rounded",children:[(0,t.jsx)(F.Folder,{className:"h-3 w-3"}),s.category?.name||"Unknown Channel"]}),(0,t.jsxs)(n.Button,{size:"sm",variant:"ghost",className:"h-6 gap-1 text-xs",onClick:()=>l.push(`/category/${s.categoryId}#memo-${s.id}`),children:["Go to Channel ",(0,t.jsx)(K,{className:"h-3 w-3"})]})]}),(0,t.jsx)(P.MemoItem,{memo:s,viewMode:o,onEditChange:e=>{var t;return t=s.id,void m(s=>{let a=new Set(s);return e?a.add(t):a.delete(t),a})},readOnly:i})]},s.id))},a))}),(0,t.jsx)("div",{ref:h})]})}),0===c.size&&!M&&!i&&(0,t.jsx)("div",{className:"p-4 bg-background border-t",children:(0,t.jsx)(u,{categoryId:e.id,onCreated:()=>{setTimeout(()=>{h.current?.scrollIntoView({behavior:"smooth"})},100)}})})]})}e.s(["MemoListContainer",()=>H],31555)}]);
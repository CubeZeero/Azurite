module.exports=[48044,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(5050),e=(0,d.createServerReference)("40802d964a6a127943dbd1d5f636967825caeed92d",d.callServer,void 0,d.findSourceMapURL,"createMemo"),f=a.i(99570),g=a.i(83952),h=a.i(70106);let i=(0,h.default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);var j=a.i(33508),k=a.i(35487);let l=(0,h.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var m=a.i(83464);function n({categoryId:a,onCreated:d}){let[h,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)([]),[s,t]=(0,c.useState)(!1),u=(0,c.useRef)(null);(0,c.useEffect)(()=>{let a=[];return q.forEach(b=>{b.type.startsWith("image/")&&a.push(URL.createObjectURL(b))}),()=>{a.forEach(a=>URL.revokeObjectURL(a))}},[q]);let v=async b=>{if(b?.preventDefault(),!h.trim()&&0===q.length&&!o.trim()||s)return;t(!0);let c=new FormData;c.append("content",h),o.trim()&&c.append("title",o.trim()),c.append("categoryId",a),q.forEach(a=>c.append("files",a));try{await e(c),n(""),p(""),r([]),d?.()}catch(a){console.error(a)}finally{t(!1)}};return(0,b.jsxs)("div",{className:"flex flex-col gap-2",children:[q.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2 px-2 pb-2",children:q.map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center gap-2 bg-muted rounded-md px-2 py-1.5 text-xs text-muted-foreground border relative group",children:[a.type.startsWith("image/")?(0,b.jsx)("img",{src:URL.createObjectURL(a),alt:a.name,className:"h-8 w-8 object-cover rounded shadow-sm"}):a.type.startsWith("video/")?(0,b.jsxs)("div",{className:"h-8 w-8 bg-black/10 flex items-center justify-center rounded shadow-sm text-foreground",children:[(0,b.jsx)(l,{className:"h-4 w-4 hidden"})," ",(0,b.jsx)(i,{className:"h-4 w-4 hidden"}),(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-film",children:[(0,b.jsx)("rect",{width:"18",height:"18",x:"3",y:"3",rx:"2"}),(0,b.jsx)("path",{d:"M7 3v18"}),(0,b.jsx)("path",{d:"M3 7.5h4"}),(0,b.jsx)("path",{d:"M3 12h18"}),(0,b.jsx)("path",{d:"M3 16.5h4"}),(0,b.jsx)("path",{d:"M17 3v18"}),(0,b.jsx)("path",{d:"M17 7.5h4"}),(0,b.jsx)("path",{d:"M17 16.5h4"})]})]}):a.type.startsWith("audio/")?(0,b.jsx)("div",{className:"h-8 w-8 bg-primary/10 flex items-center justify-center rounded shadow-sm text-primary",children:(0,b.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-music",children:[(0,b.jsx)("path",{d:"M9 18V5l12-2v13"}),(0,b.jsx)("circle",{cx:"6",cy:"18",r:"3"}),(0,b.jsx)("circle",{cx:"18",cy:"16",r:"3"})]})}):(0,b.jsx)(k.File,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"max-w-[150px] truncate",children:a.name}),(0,b.jsx)("button",{type:"button",onClick:()=>{r(q.filter((a,b)=>b!==c))},className:"ml-1 hover:text-foreground text-muted-foreground/50 transition-colors",children:(0,b.jsx)(j.X,{className:"h-3 w-3"})})]},c))}),(0,b.jsx)("div",{className:"relative flex flex-col gap-0 bg-muted/30 rounded-xl border focus-within:ring-1 focus-within:ring-ring transition-all overflow-hidden mt-0",children:(0,b.jsxs)("form",{onSubmit:v,children:[(0,b.jsx)("input",{type:"text",value:o,onChange:a=>p(a.target.value),placeholder:"Title (Optional)",className:"px-4 pt-3 pb-1 bg-transparent border-0 focus:ring-0 text-sm font-bold text-foreground placeholder:text-muted-foreground/50 w-full focus:outline-none",disabled:s}),(0,b.jsxs)("div",{className:"flex items-end gap-2 p-2 pt-0",children:[(0,b.jsx)("input",{type:"file",multiple:!0,className:"hidden",ref:u,onChange:a=>{a.target.files&&a.target.files.length>0&&r(b=>[...b,...Array.from(a.target.files)])},onClick:a=>{a.target.value=""}}),(0,b.jsxs)(f.Button,{type:"button",size:"icon",variant:"ghost",disabled:s,className:"rounded-full h-9 w-9 text-muted-foreground hover:text-foreground shrink-0 mb-0.5",onClick:()=>u.current?.click(),children:[(0,b.jsx)(g.Paperclip,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"Attach file"})]}),(0,b.jsx)(m.MarkdownInput,{value:h,onChange:a=>n(a),onPaste:a=>{if(a.clipboardData.files.length>0){let b=Array.from(a.clipboardData.files).filter(a=>a.type.startsWith("image/"));b.length>0&&(a.preventDefault(),r(a=>[...a,...b]))}},onKeyDown:a=>{"Enter"!==a.key||a.shiftKey||a.nativeEvent.isComposing||(a.preventDefault(),v())},placeholder:o?"Message...":"Message (hold Shift + Enter for new line)",className:"w-full"}),(0,b.jsxs)(f.Button,{type:"submit",size:"icon",disabled:s||!h.trim()&&0===q.length,className:"rounded-full h-9 w-9 shrink-0 mb-0.5",variant:h.trim()||q.length>0?"default":"secondary",children:[(0,b.jsx)(i,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"Send"})]})]})]})})]})}var o=a.i(69876);let p=(0,h.default)("layout-grid",[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]]),q=(0,h.default)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);var r=a.i(68114),s=a.i(97942),t=a.i(22262);function u({...a}){return(0,b.jsx)(s.Root,{"data-slot":"sheet",...a})}function v({...a}){return(0,b.jsx)(s.Trigger,{"data-slot":"sheet-trigger",...a})}function w({...a}){return(0,b.jsx)(s.Portal,{"data-slot":"sheet-portal",...a})}function x({className:a,...c}){return(0,b.jsx)(s.Overlay,{"data-slot":"sheet-overlay",className:(0,r.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",a),...c})}function y({className:a,children:c,side:d="right",...e}){return(0,b.jsxs)(w,{children:[(0,b.jsx)(x,{}),(0,b.jsxs)(s.Content,{"data-slot":"sheet-content",className:(0,r.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500","right"===d&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm","left"===d&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm","top"===d&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b","bottom"===d&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",a),...e,children:[c,(0,b.jsxs)(s.Close,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none",children:[(0,b.jsx)(t.XIcon,{className:"size-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}function z({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"sheet-header",className:(0,r.cn)("flex flex-col gap-1.5 p-4",a),...c})}function A({className:a,...c}){return(0,b.jsx)(s.Title,{"data-slot":"sheet-title",className:(0,r.cn)("text-foreground font-semibold",a),...c})}var B=a.i(1239);let C=(0,h.default)("arrow-down-to-line",[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]]);var D=a.i(62180),E=a.i(38246),F=a.i(73555),G=a.i(33821),H=a.i(87449);function I(a){let b=a.match(/(https?:\/\/[^\s]+)/g);return b?Array.from(new Set(b.map(a=>a.replace(/[.,;!?)]+$/,"")))):[]}function J({memos:a}){let[d,e]=(0,c.useState)(!1),g=a.filter(a=>a.isPinned);return(0,b.jsxs)(u,{open:d,onOpenChange:e,children:[(0,b.jsx)(v,{asChild:!0,children:(0,b.jsx)(f.Button,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",children:(0,b.jsx)(B.Pin,{className:"h-4 w-4"})})}),(0,b.jsxs)(y,{className:"overflow-y-auto w-[400px] sm:w-[540px]",children:[(0,b.jsx)(z,{children:(0,b.jsx)(A,{children:"Pinned Messages"})}),(0,b.jsx)("div",{className:"mt-4 flex flex-col gap-4 px-[5px]",children:0===g.length?(0,b.jsx)("div",{className:"text-center text-muted-foreground text-sm italic py-10",children:"No pinned messages in this channel."}):g.map(a=>(0,b.jsxs)("div",{className:"border rounded-lg overflow-hidden flex flex-col",children:[(0,b.jsxs)(E.default,{href:`?memoId=${a.id}`,className:"block p-3 hover:bg-muted/50 transition-colors text-sm flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,b.jsx)("span",{className:"font-bold text-xs truncate max-w-[200px]",children:a.title||"No Title"}),(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground",children:new Date(a.createdAt).toLocaleDateString()})]}),(0,b.jsx)("div",{className:"text-muted-foreground [&>p]:mb-1 mb-2",children:(0,b.jsx)(D.default,{components:{a:({node:a,...d})=>{let e=c.default.Children.toArray(d.children);return 1===e.length&&e[0]===d.href?null:(0,b.jsx)("span",{className:"text-primary underline",...d})}},children:a.content})}),a.attachments.length>0&&(0,b.jsx)("div",{className:"flex flex-wrap gap-2 mt-1 mb-2",children:a.attachments.map(a=>(0,b.jsx)("div",{onClick:a=>a.stopPropagation(),children:(0,b.jsx)(F.FilePreview,{attachment:a})},a.id))}),I(a.content).length>0&&(0,b.jsx)("div",{className:"mt-2 space-y-2",children:I(a.content).map(a=>{let c,d=(c=a.match(/^https?:\/\/(?:www\.)?(?:twitter|x)\.com\/\w+\/status\/(\d+)/))?c[1]:null;return d?(0,b.jsx)(H.TweetPreview,{id:d},a):(0,b.jsx)("div",{onClick:a=>a.stopPropagation(),children:(0,b.jsx)(G.LinkPreview,{url:a})},a)})})]}),(0,b.jsx)("div",{className:"p-2 border-t bg-muted/20 flex justify-end",children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:"gap-2 h-7 text-xs",onClick:()=>{var b;return b=a.id,void(e(!1),setTimeout(()=>{let a=document.getElementById(`memo-${b}`);a&&(a.scrollIntoView({behavior:"smooth",block:"center"}),a.classList.add("ring-2","ring-primary","ring-offset-2"),setTimeout(()=>{a.classList.remove("ring-2","ring-primary","ring-offset-2")},2e3))},100))},children:[(0,b.jsx)(C,{className:"h-3.5 w-3.5"}),"Jump to Memo"]})})]},a.id))})]})]})}var K=a.i(15224),L=(0,d.createServerReference)("607c4c64c68b111fc49d37ac5d1c8fe27557b1b294",d.callServer,void 0,d.findSourceMapURL,"saveWorkspaceSetting"),M=(0,d.createServerReference)("4009b196b472a3672337864e4213ada69b5c6cf7ee",d.callServer,void 0,d.findSourceMapURL,"searchMemos"),N=a.i(50944),O=a.i(66718),P=a.i(87532);let Q=(0,h.default)("globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);var R=a.i(92596);let S=(0,h.default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var T=a.i(54792);function U({category:a,initialMemos:d,initialViewMode:e="list",readOnly:g=!1}){let h=(0,N.useRouter)(),[i,j]=(0,c.useState)(e),[k,l]=(0,c.useState)(new Set),m=(0,c.useRef)(null);(0,c.useRef)(!0);let[s,t]=(0,c.useState)(""),[u,v]=(0,c.useState)("current"),[w,x]=(0,c.useState)([]),[y,z]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let a=setTimeout(async()=>{if(!s.trim())return void x([]);if("current"===u){let a=s.toLowerCase();x(d.filter(b=>!a||b.content.toLowerCase().includes(a)||b.title&&b.title.toLowerCase().includes(a)||b.tags.some(b=>b.name.toLowerCase().includes(a))||b.embeds&&b.embeds.some(b=>b.title&&b.title.toLowerCase().includes(a)||b.description&&b.description.toLowerCase().includes(a)||b.siteName&&b.siteName.toLowerCase().includes(a))))}else{z(!0);try{let a=await M(s);x(a)}catch(a){console.error("Search failed",a)}finally{z(!1)}}},300);return()=>clearTimeout(a)},[s,u,d]),(0,c.useEffect)(()=>{},[d,h]);let A=!!s.trim(),B=A?w:d,C=async a=>{j(a),await L("viewMode",a)},[D,E]=(0,c.useState)(1);(0,c.useEffect)(()=>{let a=()=>{window.innerWidth>=1280?E(3):window.innerWidth>=768?E(2):E(1)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);let F=c.default.useMemo(()=>{if("list"===i)return[B];let a=Array.from({length:D},()=>[]),b=Array(D).fill(0);return B.forEach(c=>{let d,e,f=0,g=b[0];for(let a=1;a<D;a++)b[a]<g&&(g=b[a],f=a);a[f].push(c),b[f]+=(d=100+20*Math.ceil((c.content?.length||0)/50),c.attachments?.length&&(d+=200*c.attachments.length),(e=c.content?.match(/(https?:\/\/[^\s]+)/g))&&(d+=300*e.length),d)}),a},[B,D,i]);return(0,b.jsxs)("div",{className:"flex flex-col h-full bg-background/50 backdrop-blur-sm",children:[(0,b.jsxs)(T.DraggableHeader,{className:"h-14 border-b flex items-center justify-between px-4 shrink-0 shadow-sm bg-background/80 backdrop-blur z-10 gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 font-bold text-lg shrink-0",children:[(0,b.jsx)("span",{className:"text-muted-foreground text-2xl",children:"#"}),a.name]}),(0,b.jsxs)("div",{className:"flex-1 max-w-md relative flex items-center gap-2 no-drag",style:{WebkitAppRegion:"no-drag"},children:[(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(P.Search,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(O.Input,{placeholder:g?"Search all memos...":"Search memos...",className:"pl-9 h-9 bg-background/50",value:s,onChange:a=>t(a.target.value)})]}),s&&!g&&(0,b.jsxs)("div",{className:"flex items-center border rounded-md overflow-hidden shrink-0",children:[(0,b.jsxs)("button",{onClick:()=>v("current"),className:(0,r.cn)("px-2 py-1.5 text-xs font-medium transition-colors flex items-center gap-1","current"===u?"bg-primary text-primary-foreground":"hover:bg-muted"),title:"Current Channel",children:[(0,b.jsx)(R.Folder,{className:"h-3 w-3"}),"Current"]}),(0,b.jsx)("div",{className:"w-[1px] bg-border h-full"}),(0,b.jsxs)("button",{onClick:()=>v("all"),className:(0,r.cn)("px-2 py-1.5 text-xs font-medium transition-colors flex items-center gap-1","all"===u?"bg-primary text-primary-foreground":"hover:bg-muted"),title:"All Channels",children:[(0,b.jsx)(Q,{className:"h-3 w-3"}),"All"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 shrink-0 no-drag",style:{WebkitAppRegion:"no-drag"},children:[(0,b.jsx)(J,{memos:d}),(0,b.jsxs)("div",{className:"bg-muted/50 p-1 rounded-md flex space-x-1",children:[(0,b.jsx)(f.Button,{variant:"list"===i?"secondary":"ghost",size:"icon",className:"h-7 w-7",onClick:()=>C("list"),children:(0,b.jsx)(q,{className:"h-4 w-4"})}),(0,b.jsx)(f.Button,{variant:"grid"===i?"secondary":"ghost",size:"icon",className:"h-7 w-7",onClick:()=>C("grid"),children:(0,b.jsx)(p,{className:"h-4 w-4"})})]})]})]}),(0,b.jsx)(o.ScrollArea,{className:"flex-1 min-h-0",children:(0,b.jsxs)("div",{className:"p-4 pb-4",children:[!A&&0===d.length&&(0,b.jsxs)("div",{className:"text-center text-muted-foreground py-20",children:[(0,b.jsx)("div",{className:"text-lg font-medium mb-2",children:"No memos yet"}),(0,b.jsx)("div",{className:"text-sm",children:g?"Your timeline is empty.":`Be the first to create a memo in #${a.name}!`})]}),A&&0===w.length&&!y&&(0,b.jsxs)("div",{className:"text-center text-muted-foreground py-20",children:[(0,b.jsx)("div",{className:"text-lg font-medium mb-2",children:"No results found"}),(0,b.jsx)("div",{className:"text-sm",children:"Try a different query"})]}),(0,b.jsx)("div",{className:(0,r.cn)("flex gap-4","list"===i?"flex-col":"flex-row items-start"),children:F.map((c,d)=>(0,b.jsx)("div",{className:"flex-1 flex flex-col gap-4 min-w-0",children:c.map(c=>(0,b.jsxs)("div",{id:`memo-${c.id}`,className:"relative group/memo-wrapper",children:[(g||A&&"all"===u&&c.categoryId!==a.id)&&(0,b.jsxs)("div",{className:"mb-1 flex items-center justify-between px-1",children:[(0,b.jsxs)("span",{className:"text-xs text-muted-foreground flex items-center gap-1 bg-muted/50 px-1.5 py-0.5 rounded",children:[(0,b.jsx)(R.Folder,{className:"h-3 w-3"}),c.category?.name||"Unknown Channel"]}),(0,b.jsxs)(f.Button,{size:"sm",variant:"ghost",className:"h-6 gap-1 text-xs",onClick:()=>h.push(`/category/${c.categoryId}#memo-${c.id}`),children:["Go to Channel ",(0,b.jsx)(S,{className:"h-3 w-3"})]})]}),(0,b.jsx)(K.MemoItem,{memo:c,viewMode:i,onEditChange:a=>{var b;return b=c.id,void l(c=>{let d=new Set(c);return a?d.add(b):d.delete(b),d})},readOnly:g})]},c.id))},d))}),(0,b.jsx)("div",{ref:m})]})}),0===k.size&&!A&&!g&&(0,b.jsx)("div",{className:"p-4 bg-background border-t",children:(0,b.jsx)(n,{categoryId:a.id,onCreated:()=>{setTimeout(()=>{m.current?.scrollIntoView({behavior:"smooth"})},100)}})})]})}a.s(["MemoListContainer",()=>U],48044)}];

//# sourceMappingURL=src_components_memo_memo-list-container_tsx_9643bff2._.js.map
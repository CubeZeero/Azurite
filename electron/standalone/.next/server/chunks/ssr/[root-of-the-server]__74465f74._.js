module.exports=[50227,(a,b,c)=>{b.exports=a.x("node:path",()=>require("node:path"))},68469,a=>{"use strict";var b=a.i(37936),c=a.i(83162),d=a.i(22734),e=a.i(14747);let f={viewMode:"list"};class g extends c.BaseService{settingsFile="settings.json";getSettingsPath(){return e.default.join(this.rootDir,"_system",this.settingsFile)}async getSettings(){await this.init();let a=e.default.join(this.rootDir,".system"),b=e.default.join(this.rootDir,"_system");try{await d.promises.access(a);try{await d.promises.access(b)}catch{await d.promises.rename(a,b)}}catch{}try{let a=await d.promises.readFile(this.getSettingsPath(),"utf-8");return{...f,...JSON.parse(a)}}catch(a){return f}}async updateSettings(a){await this.init();let b={...await this.getSettings(),...a},c=e.default.join(this.rootDir,"_system");try{await d.promises.access(c)}catch{await d.promises.mkdir(c,{recursive:!0})}return await d.promises.writeFile(this.getSettingsPath(),JSON.stringify(b,null,2)),b}}let h=new g;async function i(){return await h.getSettings()}async function j(a,b){await h.updateSettings({[a]:b})}(0,a.i(13095).ensureServerEntryExports)([i,j]),(0,b.registerServerReference)(i,"00cd930fcd565e1a59ebdb17fd5a197d3bea54cffa",null),(0,b.registerServerReference)(j,"607c4c64c68b111fc49d37ac5d1c8fe27557b1b294",null),a.s(["getWorkspaceSettings",()=>i,"saveWorkspaceSetting",()=>j],68469)},72312,a=>{"use strict";var b=a.i(37936);class c extends Error{constructor({message:a,status:b,data:c}){super(a),this.name="TwitterApiError",this.status=b,this.data=c}}let d=/^[0-9]+$/;async function e(a,b){var e;if(a.length>40||!d.test(a))throw Error(`Invalid tweet id: ${a}`);let f=new URL("https://cdn.syndication.twimg.com/tweet-result");f.searchParams.set("id",a),f.searchParams.set("lang","en"),f.searchParams.set("features","tfw_timeline_list:;tfw_follower_count_sunset:true;tfw_tweet_edit_backend:on;tfw_refsrc_session:on;tfw_fosnr_soft_interventions_enabled:on;tfw_show_birdwatch_pivots_enabled:on;tfw_show_business_verified_badge:on;tfw_duplicate_scribes_to_settings:on;tfw_use_profile_image_shape_enabled:on;tfw_show_blue_verified_badge:on;tfw_legacy_timeline_sunset:true;tfw_show_gov_verified_badge:on;tfw_show_business_affiliate_badge:on;tfw_tweet_edit_frontend:on"),f.searchParams.set("token",(Number(a)/1e15*Math.PI).toString(36).replace(/(0+|\.)/g,""));let g=await fetch(f.toString(),b),h=(null==(e=g.headers.get("content-type"))?void 0:e.includes("application/json"))?await g.json():void 0;if(g.ok)return(null==h?void 0:h.__typename)==="TweetTombstone"?{tombstone:!0}:{data:h};if(404===g.status)return{notFound:!0};throw new c({message:"string"==typeof h.error?h.error:`Failed to fetch tweet at "${f}" with "${g.status}".`,status:g.status,data:h})}async function f(a,b){let{data:c,tombstone:d,notFound:f}=await e(a,b);return f?console.error(`The tweet ${a} does not exist or has been deleted by the account owner. Update your code to remove this tweet when possible.`):d&&console.error(`The tweet ${a} has been made private by the account owner. Update your code to remove this tweet when possible.`),c}async function g(a){try{return await f(a)}catch(a){return console.error("Error fetching tweet:",a),null}}(0,a.i(13095).ensureServerEntryExports)([g]),(0,b.registerServerReference)(g,"406aa6f2433f5006fac34c92578275640874c1c85b",null),a.s(["fetchTweet",()=>g],72312)},34574,68060,a=>{"use strict";var b=a.i(37936),c=a.i(77438),d=a.i(18558),e=a.i(13095);async function f(a){let b=a.get("content"),e=a.get("title"),f=a.get("categoryId"),g=a.getAll("files");if((!b||!b.trim())&&0===g.length)throw Error("Content or file is required");let h=await c.memoService.createMemo(f,{content:b,title:e},g);return h.attachments=h.attachments.map(a=>({...a,url:`/api/assets/${f}/${a.url.split("/").pop()}`})),(0,d.revalidatePath)(`/category/${f}`),h}async function g(a){let b=await c.memoService.getMemo(a);return b?(b.attachments=b.attachments.map(a=>({...a,url:`/api/assets/${b.categoryId}/${a.url.split("/").pop()}`})),b):null}async function h(a,b){let e=await c.memoService.getMemo(a);if(!e)return;let f={id:crypto.randomUUID(),content:b,createdAt:new Date().toISOString(),memoId:a},g=e.comments||[];return g.push(f),await c.memoService.updateMemo(a,{comments:g}),(0,d.revalidatePath)("/"),f}async function i(a,b){await c.memoService.deleteComment(b,a),(0,d.revalidatePath)("/")}async function j(a,b,e=[]){if(!a)throw Error("Memo ID is required");await c.memoService.updateMemo(a,b,e),(0,d.revalidatePath)("/")}async function k(a){if(!a)throw Error("Memo ID is required");let b=await c.memoService.getMemo(a);b&&(await c.memoService.deleteMemo(a),(0,d.revalidatePath)(`/category/${b.categoryId}`))}async function l(a){console.warn("deleteAttachment requires memoId in this architecture")}async function m(a){return await c.memoService.searchMemos(a)}(0,e.ensureServerEntryExports)([f,g,h,i,j,k,l,m]),(0,b.registerServerReference)(f,"40802d964a6a127943dbd1d5f636967825caeed92d",null),(0,b.registerServerReference)(g,"403698dc647883b65a86904e27217d704fb65c31a1",null),(0,b.registerServerReference)(h,"60ded244b52eeede9502a4575392cda1b0a217ef0f",null),(0,b.registerServerReference)(i,"607c70bacdee3c95c523bb53006e5acee76ff02714",null),(0,b.registerServerReference)(j,"70c21166dca2c7bf2d328557f45d7fc8d70ee09aa9",null),(0,b.registerServerReference)(k,"400a7dc79d75afed64c5253e792cecd708e6b419cb",null),(0,b.registerServerReference)(l,"408d7af65ca975a71918639fc82a9fffebea725aa1",null),(0,b.registerServerReference)(m,"4009b196b472a3672337864e4213ada69b5c6cf7ee",null),a.s(["addComment",()=>h,"createMemo",()=>f,"deleteAttachment",()=>l,"deleteComment",()=>i,"deleteMemo",()=>k,"getMemo",()=>g,"searchMemos",()=>m,"updateMemo",()=>j],34574);var n=a.i(22734),o=a.i(14747),p=a.i(54799),q=a.i(83162),r=a.i(95983);class s extends q.BaseService{constructor(){super()}async getTags(a){await this.init();let b=o.default.join(this.rootDir,".system"),c=o.default.join(b,"tags.json");try{let b=await n.promises.readFile(c,"utf-8"),d=JSON.parse(b);if(!a)return d;return d.filter(b=>b.name.toLowerCase().includes(a.toLowerCase())).slice(0,5)}catch{return[]}}async addTagToMemo(a,b){let d=await c.memoService.getMemo(a);if(!d)throw Error("Memo not found");let e=await r.categoryService.getCategoryPath(d.categoryId);if(!e)throw Error("Category path not found");let f=o.default.join(this.rootDir,".system"),g=o.default.join(f,"tags.json"),h=[];try{let a=await n.promises.readFile(g,"utf-8");h=JSON.parse(a)}catch{}let i=h.find(a=>a.name===b);i||(i={id:(0,p.randomUUID)(),name:b},h.push(i),await n.promises.mkdir(f,{recursive:!0}),await n.promises.writeFile(g,JSON.stringify(h,null,2))),d.tags.some(a=>a.name===b)||(d.tags.push(i),await n.promises.writeFile(o.default.join(e,`${a}.json`),JSON.stringify(d,null,2)))}}let t=new s;async function u(a,b){let c=b.trim();if(c){await t.addTagToMemo(a,c);try{(0,d.revalidatePath)("/")}catch(a){console.error("Revalidate failed (non-fatal)",a)}}}async function v(a){return a?await t.getTags(a):[]}(0,e.ensureServerEntryExports)([u,v]),(0,b.registerServerReference)(u,"60ff376a54db6e6cb53fc9ab95f93a9dc026b6a162",null),(0,b.registerServerReference)(v,"40229b072f8a063ad09d49f156040a3708ba6c2bc5",null),a.s(["addTagToMemo",()=>u,"searchTags",()=>v],68060)},54439,a=>{"use strict";var b=a.i(8574),c=a.i(34574),d=a.i(68060),e=a.i(33927),f=a.i(72312),g=a.i(68469);a.s([],86776),a.i(86776),a.s(["00cd930fcd565e1a59ebdb17fd5a197d3bea54cffa",()=>g.getWorkspaceSettings,"00e29274c74618e1fd6113eb5eb431b404f7b0f297",()=>b.getCategories,"4009b196b472a3672337864e4213ada69b5c6cf7ee",()=>c.searchMemos,"400a7dc79d75afed64c5253e792cecd708e6b419cb",()=>c.deleteMemo,"40229b072f8a063ad09d49f156040a3708ba6c2bc5",()=>d.searchTags,"403698dc647883b65a86904e27217d704fb65c31a1",()=>c.getMemo,"406aa6f2433f5006fac34c92578275640874c1c85b",()=>f.fetchTweet,"40802d964a6a127943dbd1d5f636967825caeed92d",()=>c.createMemo,"408d7af65ca975a71918639fc82a9fffebea725aa1",()=>c.deleteAttachment,"40925b8f2377d2c5e7710ccb8857b9e0afb4a27438",()=>b.deleteCategory,"40f4d1a11929d4dc0159e49f1b64e64c88757f0053",()=>e.getOgp,"606da99dfc16db5749fb7ba1439c5e71bc88bb2dbb",()=>b.moveCategory,"607c4c64c68b111fc49d37ac5d1c8fe27557b1b294",()=>g.saveWorkspaceSetting,"607c70bacdee3c95c523bb53006e5acee76ff02714",()=>c.deleteComment,"60b0c1fd0d1fc1df7f38136c8944adbeedf5836995",()=>b.renameCategory,"60ded244b52eeede9502a4575392cda1b0a217ef0f",()=>c.addComment,"60ff376a54db6e6cb53fc9ab95f93a9dc026b6a162",()=>d.addTagToMemo,"701d7325082596205f312f2ca42a3ca62d9d770c0b",()=>b.createCategory,"70c21166dca2c7bf2d328557f45d7fc8d70ee09aa9",()=>c.updateMemo],54439)},95185,a=>{a.v(a=>Promise.resolve().then(()=>a(72312)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__74465f74._.js.map